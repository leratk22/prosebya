/**
 * Маппинг симптомов на типы контента (практики, медитации, лонгриды, курсы) для бесплатной подписки.
 */

export interface SymptomContentTypes {
  fast_practices: string;
  meditations: string;
  longreads: string;
  courses: string;
}

export const CONTENT_BY_SYMPTOM: Record<string, SymptomContentTypes> = {
  "Проблема с питанием и весом": {
    fast_practices: "Техника 'Остановка перед перекусом'",
    meditations: "Медитация на осознанное насыщение",
    longreads: "Почему диеты не работают: психология пищевого поведения",
    courses: "Путь к гармонии с едой: от контроля к принятию",
  },
  "Сексуальное здоровье": {
    fast_practices: "Упражнение на контакт с телом 'Сканирование'",
    meditations: "Медитация на снятие блоков и зажимов",
    longreads: "Сексуальность и либидо: как стресс влияет на наше желание",
    courses: "Психология сексуальности: возвращение чувствительности",
  },
  "Панические атаки": {
    fast_practices: "Техника заземления '5-4-3-2-1'",
    meditations: "Медитация 'Тихая гавань' для купирования тревоги",
    longreads: "Что происходит с телом при панике и как этим управлять",
    courses: "Жизнь без паники: пошаговый план преодоления страха",
  },
  "Проблемы со сном": {
    fast_practices: "Дыхание '4-7-8' перед сном",
    meditations: "Вечерняя медитация на глубокое расслабление",
    longreads: "Гигиена сна: почему мозг не хочет засыпать",
    courses: "Мастерство сна: восстанавливаем биоритмы за 21 день",
  },
  "Потеря работы": {
    fast_practices: "Аффирмации на внутреннюю опору",
    meditations: "Медитация 'Новые возможности и уверенность'",
    longreads: "Кризис как точка роста: что делать, если вы остались без работы",
    courses: "Перезагрузка карьеры: от стресса к новому офферу",
  },
  "Горе и утрата": {
    fast_practices: "Письменная практика 'Письмо выражения чувств'",
    meditations: "Медитация на бережное проживание печали",
    longreads: "Стадии горевания: как помочь себе пережить потерю",
    courses: "Жизнь после: бережное сопровождение в период утраты",
  },
  "Нехимическая зависимость": {
    fast_practices: "Метод '10 минут ожидания'",
    meditations: "Медитация на освобождение от навязчивых импульсов",
    longreads: "Дофаминовая ловушка: как работают поведенческие аддикции",
    courses: "Свобода от привычек: как вернуть контроль над своей жизнью",
  },
  "Развод": {
    fast_practices: "Упражнение 'Разделение реальностей'",
    meditations: "Медитация на отпускание прошлого",
    longreads: "Жизнь после развода: как собрать себя заново",
    courses: "Новая глава: психология восстановления после расставания",
  },
  "Принятие своего тела": {
    fast_practices: "Упражнение 'Благодарность частям тела'",
    meditations: "Медитация на безусловное принятие внешности",
    longreads: "Мой храм — мое тело: как перестать воевать с зеркалом",
    courses: "Бодипозитив и самопринятие: путь к внутренней свободе",
  },
  "Химическая зависимость": {
    fast_practices: "SOS-техника 'Переключение внимания'",
    meditations: "Медитация 'Осознанная трезвость'",
    longreads: "Механизмы зависимости: почему силы воли недостаточно",
    courses: "Основы выздоровления: психологическая поддержка при зависимостях",
  },
  "Хроническая болезнь": {
    fast_practices: "Техника управления болевым фокусом",
    meditations: "Медитация на ресурсное состояние тела",
    longreads: "Психосоматика и адаптация к жизни с диагнозом",
    courses: "Жить полноценно: психологическая устойчивость при болезни",
  },
  "Насилие": {
    fast_practices: "Практика 'Безопасное место'",
    meditations: "Медитация на восстановление личных границ",
    longreads: "Выход из цикла насилия: как распознать и защитить себя",
    courses: "Исцеление травмы: путь к безопасности и достоинству",
  },
  "Страх смерти": {
    fast_practices: "Упражнение 'Здесь и сейчас'",
    meditations: "Медитация на принятие конечности бытия",
    longreads: "Экзистенциальная тревога: почему мы боимся конца",
    courses: "Смысл жизни и страх смерти: экзистенциальная терапия",
  },
  "Продуктивность в работе": {
    fast_practices: "Метод 'Помидор' в новом прочтении",
    meditations: "Медитация на ясный ум и концентрацию",
    longreads: "Анатомия фокуса: как работать меньше, но успевать больше",
    courses: "Архитектура продуктивности: системы эффективной работы",
  },
  "Прокрастинация": {
    fast_practices: "Правило 2-х минут",
    meditations: "Медитация на преодоление внутреннего сопротивления",
    longreads: "Почему мы откладываем жизнь на потом: страх успеха и неудачи",
    courses: "Победа над прокрастинацией: откладывание в прошлом",
  },
  "Финансовая эффективность": {
    fast_practices: "Упражнение 'Стоимость импульса'",
    meditations: "Медитация на изобилие и снятие ограничений",
    longreads: "Психология денег: как наши убеждения влияют на кошелек",
    courses: "Финансовое мышление: порядок в голове — порядок в деньгах",
  },
  "Стресс и выгорание": {
    fast_practices: "Квадратное дыхание для снятия стресса",
    meditations: "Медитация 'Полная разрядка'",
    longreads: "Эмоциональное выгорание: как не сгореть на работе",
    courses: "Антихрупкость: курс по восстановлению после стресса",
  },
  "Баланс работы и жизни": {
    fast_practices: "Техника 'Колесо баланса' за 5 минут",
    meditations: "Медитация на переключение из рабочего режима в личный",
    longreads: "Work-Life Balance: миф или достижимая реальность?",
    courses: "Искусство равновесия: строим гармоничную жизнь",
  },
  "Лидерство и управление": {
    fast_practices: "Практика 'Эмпатичное слушание'",
    meditations: "Медитация на развитие уверенности лидера",
    longreads: "Эмоциональный интеллект в управлении командой",
    courses: "Лидер нового времени: от контроля к доверию",
  },
  "Профессиональный рост": {
    fast_practices: "Упражнение 'Мои сильные стороны'",
    meditations: "Медитация на визуализацию карьерного пути",
    longreads: "Синдром самозванца: что мешает вашему росту",
    courses: "Стратегия карьеры: как расти в профессии без надрыва",
  },
  "Самоопределение": {
    fast_practices: "Техника 'Кто я?' (10 ответов)",
    meditations: "Медитация на поиск внутреннего центра",
    longreads: "Кризис самоопределения: как найти свой путь в меняющемся мире",
    courses: "Архитектор своей жизни: курс по поиску идентичности",
  },
  "Конфликты на работе": {
    fast_practices: "Метод 'Я-высказывание' в офисе",
    meditations: "Медитация на эмоциональную устойчивость в споре",
    longreads: "Токсичный коллега или рабочие разногласия: как выйти победителем",
    courses: "Мастерство коммуникации: разрешение конфликтов без потерь",
  },
  "Отношения в коллективе": {
    fast_practices: "Практика 'Маленькая благодарность'",
    meditations: "Медитация на развитие эмпатии к окружающим",
    longreads: "Психология команды: как построить здоровые отношения на работе",
    courses: "Командная химия: искусство взаимодействия и поддержки",
  },
  "Плохое настроение": {
    fast_practices: "Упражнение 'Улыбка глазами'",
    meditations: "Медитация для поднятия тонуса и настроения",
    longreads: "Биохимия радости: как поднять настроение без сахара",
    courses: "Эмоциональная гигиена: как управлять своим фоном настроения",
  },
  "Мысли о суициде": {
    fast_practices: "Техника 'План безопасности' (найти поддержку)",
    meditations: "Медитация на бережное присутствие и самосострадание",
    longreads: "Когда тьма сгущается: почему важно просить о помощи",
    courses: "Точка опоры: психологическая поддержка в кризисные моменты",
  },
  "Эмоциональное напряжение": {
    fast_practices: "Прогрессивная мышечная релаксация",
    meditations: "Медитация на освобождение от накопленных эмоций",
    longreads: "Как контейнировать эмоции и не взрываться",
    courses: "Эмоциональный интеллект: управление внутренним напряжением",
  },
  "Рассеянность": {
    fast_practices: "Техника 'Якорь внимания'",
    meditations: "Медитация на осознанность (Mindfulness)",
    longreads: "Информационный шум: как вернуть себе способность концентрироваться",
    courses: "Внимание — это суперсила: тренировка фокуса",
  },
  "Страх и тревога": {
    fast_practices: "Техника 'А что если?' (позитивный сценарий)",
    meditations: "Медитация на растворение тревожных мыслей",
    longreads: "Природа страха: как превратить тревогу в союзника",
    courses: "Свобода от тревоги: практическое руководство",
  },
  "Перепады настроения": {
    fast_practices: "Дневник эмоций за 2 минуты",
    meditations: "Медитация на стабилизацию эмоционального фона",
    longreads: "Гормональные качели: почему настроение меняется так резко",
    courses: "Эмоциональные качели: как обрести устойчивость",
  },
  "Раздражительность": {
    fast_practices: "Метод 'Пауза перед реакцией'",
    meditations: "Медитация на внутреннее спокойствие и терпимость",
    longreads: "Гнев и раздражение: о чем на самом деле говорит ваша злость",
    courses: "Укрощение строптивых эмоций: работа с гневом",
  },
  "Апатия": {
    fast_practices: "Микро-действие для запуска энергии",
    meditations: "Медитация на пробуждение жизненной силы",
    longreads: "Апатия — это не лень: как вернуть вкус к жизни",
    courses: "Из тени в свет: выход из состояния апатии",
  },
  "Чувство одиночества": {
    fast_practices: "Упражнение 'Связь с миром через чувства'",
    meditations: "Медитация на любящую доброту к себе",
    longreads: "Один или одинок: как найти близость в мире людей",
    courses: "Искусство близости: от одиночества к качественным связям",
  },
  "Трудности в общении": {
    fast_practices: "Техника открытого вопроса",
    meditations: "Медитация на снятие социального барьера",
    longreads: "Социальная тревожность: как перестать бояться общения",
    courses: "Коммуникация без страха: как общаться легко и уверенно",
  },
  "Отношения с детьми": {
    fast_practices: "Техника '15 минут качественного внимания'",
    meditations: "Медитация на терпение и родительский ресурс",
    longreads: "Теория привязанности: как понять своего ребенка",
    courses: "Осознанное родительство: без криков и наказаний",
  },
  "Отношения в паре": {
    fast_practices: "Практика благодарности партнеру",
    meditations: "Медитация на углубление близости и любви",
    longreads: "Языки любви: как говорить так, чтобы вас услышали",
    courses: "Гармония двоих: курс по построению крепких отношений",
  },
  "Конфликты с близкими": {
    fast_practices: "Метод 'Тайм-аут' в споре",
    meditations: "Медитация на прощение и отпускание обид",
    longreads: "Семейные войны: как конфликтовать конструктивно",
    courses: "Мирная семья: искусство диалога с родными",
  },
  "Отношения в семье": {
    fast_practices: "Упражнение 'Семейные традиции'",
    meditations: "Медитация на исцеление родовых связей",
    longreads: "Системная семейная психология: почему мы повторяем сценарии",
    courses: "Семья как система: создаем здоровый климат",
  },
  "Взросление и сепарация": {
    fast_practices: "Упражнение 'Моя территория'",
    meditations: "Медитация на отделение от родительских ожиданий",
    longreads: "Пора съезжать: психологическая и физическая сепарация",
    courses: "Стать взрослым: путь к независимости и ответственности",
  },
  "Трудно принимать решения": {
    fast_practices: "Квадрат Декарта за 5 минут",
    meditations: "Медитация на контакт с интуицией",
    longreads: "Страх ошибки: почему мы застреваем в неопределенности",
    courses: "Алгоритм выбора: как принимать решения смело и быстро",
  },
  "Проблемы с самооценкой": {
    fast_practices: "Список достижений дня",
    meditations: "Медитация на осознание собственной ценности",
    longreads: "Самооценка и самоценность: в чем разница и как их поднять",
    courses: "Уверенность внутри: курс по работе над самооценкой",
  },
  "Творческое развитие": {
    fast_practices: "Практика 'Утренние страницы'",
    meditations: "Медитация на раскрытие творческого потока",
    longreads: "Творческий кризис: как вернуть музу",
    courses: "Путь художника: раскрываем ваш творческий потенциал",
  },
  "Поиск себя и смысла жизни": {
    fast_practices: "Техника Икигай (быстрый набросок)",
    meditations: "Медитация на встречу с собой будущим",
    longreads: "В чем смысл? Психологические аспекты предназначения",
    courses: "Навигатор жизни: найти свои истинные ценности",
  },
  "Личные границы": {
    fast_practices: "Техника отказа 'Вежливое НЕТ'",
    meditations: "Медитация на укрепление личного пространства",
    longreads: "Где заканчиваюсь я и начинаются другие: все о границах",
    courses: "Личные границы: искусство защиты без агрессии",
  },
};

/**
 * Возвращает список контента для показа в блоке рекомендаций по выбранным симптомам.
 * Для каждого симптома добавляются 4 типа контента (практика, медитация, лонгрид, курс).
 * Ограничение: максимум 2 симптома (8 карточек), чтобы не перегружать экран.
 */
export function getContentForSymptoms(symptoms: string[]): Array<{ label: string; value: string }> {
  const chips: Array<{ label: string; value: string }> = [];
  const seen = new Set<string>();
  let symptomCount = 0;
  const maxSymptoms = 2;

  for (const symptom of symptoms) {
    if (symptomCount >= maxSymptoms) break;
    const content = CONTENT_BY_SYMPTOM[symptom];
    if (!content) continue;

    const keys: (keyof SymptomContentTypes)[] = ["fast_practices", "meditations", "longreads", "courses"];
    for (const key of keys) {
      const title = content[key];
      if (title && !seen.has(title)) {
        seen.add(title);
        chips.push({
          label: title,
          value: `${symptom}__${key}`,
        });
      }
    }
    symptomCount += 1;
  }

  if (chips.length === 0) {
    const fallback = CONTENT_BY_SYMPTOM["Поиск себя и смысла жизни"];
    if (fallback) {
      const keys: (keyof SymptomContentTypes)[] = ["fast_practices", "meditations", "longreads", "courses"];
      keys.forEach((key) => {
        chips.push({
          label: fallback[key],
          value: `fallback__${key}`,
        });
      });
    }
  }

  return chips;
}
