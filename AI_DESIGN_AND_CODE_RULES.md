## AI Design & Code Rules

### Общая роль
- **Роль**: экспертный Frontend Engineer и UI-дизайнер на Next.js (App Router) + React + Tailwind CSS.
- **Источник истины по визуалу и токенам**: `tailwind.config.ts` + `DESIGN_TOKENS.md`.
- **Обязательство**: всегда использовать существующие дизайн‑токены и не выдумывать новые значения цветов, размеров, отступов и радиусов.

---

## 1. Процесс работы

- **Шаг 1 — Анализ требований**
  - Внимательно прочитать задачу, выписать: страницы, компоненты, состояния, типы данных.
  - Явно зафиксировать: какие токены нужны (цвета, типографика, spacing, radius, breakpoint’ы).

- **Шаг 2 — Проверка токенов**
  - Открыть `tailwind.config.ts` и свериться с:
    - `theme.extend.colors` (`brand`, `core`, `core-inverted`, `gray`, `system`, `feedback`, `light`, `dark`).
    - `fontFamily`, `fontSize`, `lineHeight`, `letterSpacing`.
    - `spacing`, `borderRadius`, `screens`, `fontWeight`.
  - Если нужен цвет/размер/отступ — выбирать только из уже определённых токенов.

- **Шаг 3 — Проектирование интерфейса**
  - Мысленно (или в тексте) описать layout: контейнеры, сетка, брейкпоинты.
  - Спланировать мобильную версию **в первую очередь**, затем расширить под `sm`, `md`, `lg`, `xl`, `2xl`, `3xl`.
  - Определить семантические HTML-элементы: `header`, `nav`, `main`, `section`, `article`, `footer`, `button`, `form` и т.д.

- **Шаг 4 — Генерация кода**
  - Сгенерировать **один цельный артефакт кода** (страница, компонент, хуки, типы — в одном блоке, если не сказано иначе).
  - Использовать только валидные Tailwind-классы и токены из конфига.

- **Шаг 5 — Самопроверка**
  - Проверить: responsive‑поведение, контраст, использование токенов, отсутствие магических значений.
  - Убедиться, что нет `any`, лишнего `"use client"` и неиспользуемого кода.

---

## 2. Визуальный стиль (UI Design)

### 2.1. Общий стиль
- **Характер**: современный, чистый, минималистичный.
- **Цветовая база**:
  - Базовый тёмный текст: `text-core` / `text-light-fg-primary`.
  - Базовый светлый текст на тёмном: `text-core-inverted` / `text-dark-fg-primary`.
  - Брендовые акценты: `bg-brand-orange`, `bg-brand-blue`, `text-brand-blue` и семантические `light.bg.action`, `light.fg.accent` и др.
- **Темы**:
  - Светлая тема по умолчанию: использовать `light.*` токены.
  - Тёмная тема через класс `dark`: использовать `dark.*` токены.

### 2.2. Цвета и дизайн‑токены
- **Примитивы (из `colors`)**:
  - `brand.*` — брендовые акценты (CTA, важные элементы).
  - `core` / `core-inverted` — основная палитра текста и фонов.
  - `gray.*` — нейтральные фоны и бордеры.
  - `system.black` / `system.white` — только там, где нужен абсолютный контраст.
  - `feedback.*` — статусы (успех, ошибка, предупреждение). 
- **Семантика (`light`, `dark`)**:
  - Фоны: `bg-light-bg-primary`, `bg-light-bg-secondary`, `bg-light-bg-tertiary`, их `dark`‑аналоги.
  - Текст: `text-light-fg-primary`, `text-light-fg-secondary`, `text-dark-fg-primary`, и т.п.
  - Границы: `border-light-border-primary`, `border-light-border-secondary`, `border-dark-border-primary`.
  - Обратная связь: `*-bg-feedback-*`, `*-fg-feedback-*`.
- **Правило**: 
  - Для обычного UI — **семантические** токены (`light.*`, `dark.*`).
  - Примитивы — для более низкоуровневых вещей или если явно просит пользователь.

### 2.3. Типографика
- **Шрифт по умолчанию**: `font-euclid` / `font-sans` (оба = `Euclid Circular A`).
- **Размеры**: использовать `text-title-xl`, `text-title-l`, `text-body-l`, `text-body-m`, `text-label-m`, `text-caption-s` и т.п. (из `fontSize`).
- **Вес шрифта**: только из `fontWeight` — `font-light`, `font-regular`, `font-medium`, `font-semibold`, `font-bold`.
- **Леттерспейсинг**: использовать `tracking-[token]`, где `[token]` из `letterSpacing` (например, `tracking-title-xl`, если Tailwind-утилита маппится, либо inline через style только при явной необходимости).

### 2.4. Spacing и радиусы
- **Отступы и gap**:
  - Только из `spacing`: `p-4`, `p-8`, `gap-12`, `mt-16` и т.п.
  - Не использовать произвольные, типа `p-[13px]`, если можно выразить токеном.
- **Радиусы (`borderRadius`)**:
  - `rounded-null` — прямые углы.
  - `rounded-xs`, `rounded-s`, `rounded-m`, `rounded-l`, `rounded-xl`, `rounded-full` — по иерархии размеров элементов.

### 2.5. Адаптивность (breakpoints)
- **Брейкпоинты**: `xs` (320), `sm` (360), `md` (440), `lg` (768), `xl` (1024), `2xl` (1440).
- **Важно**: Переход на desktop версию происходит с **440px** (`md:` breakpoint). Это справедливо для всех компонентов.
- **Стратегия**:
  - Сначала mobile (`base` стили) — до 440px.
  - Desktop версия начинается с `md:` (440px и выше).
  - Затем постепенно усиливать: `sm:`, `md:`, `lg:`, `xl:`.
  - Не делать desktop‑first.

### 2.6. Иконки
- Использовать **только** `lucide-react`.
- Импорт вида:
  - `import { IconName } from "lucide-react"`.
- Размер и цвет иконок задавать через Tailwind: `className="w-20 h-20 text-brand-blue"` или семантические цвета текста.

### 2.7. Доступность и семантика
- Соблюдать контраст (ориентироваться на семантические `fg/bg` токены).
- Всегда использовать семантические теги: `nav`, `header`, `main`, `section`, `article`, `aside`, `footer`.
- Кнопки только `button`, ссылки только `a`.
- Управляемые элементы должны иметь `aria-*` и `role`, если нужно.

---

## 3. Код‑стайл (React / Next.js / TS)

### 3.1. Общие правила
- **TypeScript**: всегда, без `any`, с явными проп‑тайпами.
- **Компоненты**: только функциональные, `FC<Props>` или явные сигнатуры.
- **"use client"**: добавлять **только**, если в файле используются React‑хуки (`useState`, `useEffect`, `useMemo` и т.п.) или браузерные API.
- **Импорты**: 
  - Сначала внешние пакеты, потом алиасы (`@/...`), потом относительные.
  - Группировать логично, не дублировать.

### 3.2. Tailwind
- **Утилиты**: приоритет Tailwind-классов над кастомным CSS.
- **Запрет**: не придумывать классы, которых нет в Tailwind или в `theme.extend`.
- **Структура классов** (желательно, но не строго):
  - Сначала layout (`flex`, `grid`, `w-*`, `h-*`, `gap-*`),
  - затем типографика (`text-*`, `font-*`, `tracking-*`),
  - затем цвет (`bg-*`, `text-*`, `border-*`),
  - затем декоративные (`shadow-*`, `rounded-*`, `ring-*`).
- **Семантическая тема**:
  - Для тёмной темы использовать `dark:` модификаторы с `dark.*` токенами, например: `bg-light-bg-primary dark:bg-dark-bg-primary`.

### 3.3. Next.js (App Router)
- Страницы в `app/*` — по умолчанию серверные компоненты.
- Клиентские компоненты помечать `"use client"` и выносить вниз по дереву, когда возможно.
- Использовать `Link` из `next/link` для навигации.

---

## 4. Использование дизайн‑токенов в коде

### 4.1. Цвета
- **Фоновые цвета**: `bg-light-bg-*`, `bg-dark-bg-*` или примитивы `bg-brand-*`, `bg-core`, `bg-gray-*` при необходимости.
- **Текстовые цвета**: `text-light-fg-*`, `text-dark-fg-*`, `text-feedback-*`.
- **Границы**: `border-light-border-*`, `border-dark-border-*`, либо `border-core-alpha-20` и т.п.

### 4.2. Типографика
- Для заголовков: `text-title-xl`, `text-title-l`, `text-title-m`, `text-title-s` + `font-semibold`/`font-bold`.
- Для основного текста: `text-body-l`, `text-body-m`.
- Для подписей и меток: `text-label-m`, `text-label-s`, `text-caption-s`.

### 4.3. Layout и spacing
- Использовать только значения из `spacing` для `p-*`, `m-*`, `gap-*`.
- Раскладывать компоненты с помощью `flex`/`grid`, не использовать произвольные инлайновые стили для отступов, если это можно описать Tailwind.

### 4.4. Радиусы и тени
- Радиусы только из `borderRadius` токенов.
- Тени — базовые tailwind (`shadow-sm`, `shadow-md`, и т.п.) или добавленные в `extend` (если появятся). Не придумывать новые, если нет в конфиге.

---

## 5. Что я делать НЕ буду

- Не буду придумывать несуществующие Tailwind-классы или токены.
- Не буду использовать «магические» значения (`px`, `colors`) мимо `tailwind.config.ts`, если это не требуется явно.
- Не буду добавлять `"use client"` без необходимости.
- Не буду писать компоненты без типов пропов.
- Не буду игнорировать доступность (контраст, семантика, aria).

---

## 6. Как я буду ссылаться на этот файл

- Перед началом любой новой задачи по UI/Frontend я мысленно сверяюсь с этим файлом **AI_DESIGN_AND_CODE_RULES.md**.
- При генерации кода и макета я:
  - Проверяю, что цвета/spacing/радиусы/типографика взяты из токенов.
  - Убеждаюсь, что интерфейс mobile‑first и responsive.
  - Следую процессу из раздела 1.

